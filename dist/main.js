(()=>{"use strict";var e={77(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.planStructures=function(e){Memory.planning||(Memory.planning={plannedStructures:[],spawnSquareRoadAnchorPositions:[],currentStage:1});const t=Memory.planning;void 0===t.currentStage&&(t.currentStage=1),t.plannedStructures||(t.plannedStructures=[]),t.spawnSquareRoadAnchorPositions||(t.spawnSquareRoadAnchorPositions=[]);const o=t.currentStage,n=e.find(FIND_MY_CONSTRUCTION_SITES),s=e.find(FIND_SOURCES).filter(e=>!(0,r.isSourceSafe)(e));if(t.plannedStructures=t.plannedStructures.filter(t=>{if(t.pos.roomName!==e.name&&o<7)return!1;const r=new RoomPosition(t.pos.x,t.pos.y,t.pos.roomName);return!s.some(e=>r.inRangeTo(e,10))}),1===o){const o=e.find(FIND_MY_SPAWNS);if(o.length>0){const n=o[0],s=[{dx:-2,dy:0},{dx:2,dy:0},{dx:0,dy:-2},{dx:0,dy:2},{dx:-1,dy:-1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:1,dy:1}];for(const o of s){const s=new RoomPosition(n.pos.x+o.dx,n.pos.y+o.dy,e.name);(0,r.addPlannedStructure)(t.plannedStructures,s,STRUCTURE_ROAD,"to_build",e)&&t.spawnSquareRoadAnchorPositions.push(s)}}const s=t.plannedStructures.filter(o=>o.pos.roomName===e.name&&o.structureType===STRUCTURE_ROAD&&t.spawnSquareRoadAnchorPositions.some(e=>e.x===o.pos.x&&e.y===o.pos.y));s.length>0&&s.every(e=>"built"===e.status)&&0===n.length&&(t.currentStage=2)}if(2===o){const o=e.find(FIND_MY_SPAWNS)[0];if(!o)return;const s=5;if(t.plannedStructures.filter(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_EXTENSION).length+e.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_EXTENSION}}).length<s)for(const n of t.spawnSquareRoadAnchorPositions){if(t.plannedStructures.filter(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_EXTENSION).length>=s)break;const a=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(const i of a){const a=new RoomPosition(n.x+i.dx,n.y+i.dy,n.roomName);if(e.getTerrain().get(a.x,a.y)!==TERRAIN_MASK_WALL&&!a.isEqualTo(o.pos)&&!t.plannedStructures.some(e=>e.pos.x===a.x&&e.pos.y===a.y)&&(0,r.addPlannedStructure)(t.plannedStructures,a,STRUCTURE_EXTENSION,"to_build",e)&&t.plannedStructures.filter(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_EXTENSION).length>=s)break}}const a=t.plannedStructures.filter(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_EXTENSION);a.length>=5&&a.every(e=>"built"===e.status)&&0===n.length&&(t.currentStage=3)}if(3===o){const o=e.find(FIND_SOURCES).filter(e=>(0,r.isSourceSafe)(e)),s=t.spawnSquareRoadAnchorPositions.map(e=>new RoomPosition(e.x,e.y,e.roomName));for(const n of o)if(!t.plannedStructures.some(t=>{const o=new RoomPosition(t.pos.x,t.pos.y,t.pos.roomName);return t.pos.roomName===e.name&&t.structureType===STRUCTURE_ROAD&&o.isNearTo(n.pos)})){const o=(0,r.findClosestAnchor)(n.pos,s);if(o){const s=PathFinder.search(n.pos,{pos:o,range:1},{plainCost:2,swampCost:10,roomCallback:t=>{let o=new PathFinder.CostMatrix;return e.find(FIND_STRUCTURES).forEach(e=>{e.structureType!==STRUCTURE_ROAD&&o.set(e.pos.x,e.pos.y,255)}),o}}).path;for(const o of s)(0,r.addPlannedStructure)(t.plannedStructures,o,STRUCTURE_ROAD,"to_build",e)}}const a=t.plannedStructures.filter(o=>o.pos.roomName===e.name&&o.structureType===STRUCTURE_ROAD&&!t.spawnSquareRoadAnchorPositions.some(e=>e.x===o.pos.x&&e.y===o.pos.y));a.length>0&&a.every(e=>"built"===e.status)&&0===n.length&&(t.currentStage=4)}if(4===o){if(e.controller){const o=t.spawnSquareRoadAnchorPositions.map(e=>new RoomPosition(e.x,e.y,e.roomName)),n=(0,r.findClosestAnchor)(e.controller.pos,o);if(n){const o=PathFinder.search(e.controller.pos,{pos:n,range:1},{plainCost:2,swampCost:10}).path;for(const n of o)(0,r.addPlannedStructure)(t.plannedStructures,n,STRUCTURE_ROAD,"to_build",e)}}0===t.plannedStructures.filter(o=>o.pos.roomName===e.name&&"built"!==o.status&&!t.spawnSquareRoadAnchorPositions.some(e=>e.x===o.pos.x&&e.y===o.pos.y)&&o.structureType===STRUCTURE_ROAD).length&&0===n.length&&(t.currentStage=6)}if(6===o){const o=e.find(FIND_SOURCES).filter(e=>(0,r.isSourceSafe)(e));for(const n of o)if(!(e.find(FIND_STRUCTURES,{filter:e=>e.structureType===STRUCTURE_CONTAINER&&e.pos.inRangeTo(n,2)}).length>0||t.plannedStructures.some(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_CONTAINER&&new RoomPosition(t.pos.x,t.pos.y,t.pos.roomName).inRangeTo(n,2)))){const o=t.plannedStructures.find(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_ROAD&&new RoomPosition(t.pos.x,t.pos.y,t.pos.roomName).isNearTo(n.pos));if(o){const n=new RoomPosition(o.pos.x,o.pos.y,o.pos.roomName);(0,r.addPlannedStructure)(t.plannedStructures,n,STRUCTURE_CONTAINER,"to_build",e)}}if(e.controller&&!(e.find(FIND_STRUCTURES,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.pos.inRangeTo(e.controller,3)}).length>0||t.plannedStructures.some(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_CONTAINER&&new RoomPosition(t.pos.x,t.pos.y,t.pos.roomName).inRangeTo(e.controller,3)))){const o=[{dx:1,dy:1},{dx:-1,dy:1},{dx:1,dy:-1},{dx:-1,dy:-1}];for(const n of o){const o=new RoomPosition(e.controller.pos.x+n.dx,e.controller.pos.y+n.dy,e.name);if(e.getTerrain().get(o.x,o.y)!==TERRAIN_MASK_WALL&&!t.plannedStructures.some(e=>e.pos.x===o.x&&e.pos.y===o.y)&&(0,r.addPlannedStructure)(t.plannedStructures,o,STRUCTURE_CONTAINER,"to_build",e))break}}const s=t.plannedStructures.filter(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_CONTAINER);s.length>0&&s.every(e=>"built"===e.status)&&0===n.length&&(console.log("Planner: Stage 6 (Containers) Complete. Advancing to Stage 7 (Remote Roads)."),t.currentStage=7)}if(7===o){if(!Memory.remoteMining)return;const o=t.spawnSquareRoadAnchorPositions.map(e=>new RoomPosition(e.x,e.y,e.roomName));let s=!1;for(const n in Memory.remoteMining){const a=Memory.remoteMining[n];if(!a.isHostile&&Game.rooms[n])for(const i of a.sources){const a=Game.getObjectById(i);if(a&&!t.plannedStructures.some(e=>{const t=new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName);return e.pos.roomName===n&&e.structureType===STRUCTURE_ROAD&&t.isNearTo(a.pos)})){const n=(0,r.findClosestAnchor)(a.pos,o);if(n){const o=PathFinder.search(a.pos,{pos:n,range:1},{plainCost:2,swampCost:10,roomCallback:e=>{const o=new PathFinder.CostMatrix;return t.plannedStructures.forEach(e=>{e.structureType===STRUCTURE_ROAD&&o.set(e.pos.x,e.pos.y,1)}),o}}).path;for(const n of o)(0,r.addPlannedStructure)(t.plannedStructures,n,STRUCTURE_ROAD,"to_build",e)&&(s=!0)}}}}const a=t.plannedStructures.filter(t=>t.pos.roomName!==e.name&&t.structureType===STRUCTURE_ROAD);a.length>0&&a.every(e=>"built"===e.status)&&0===n.length&&(console.log("Planner: Stage 7 Complete. Advancing to Stage 8 (Tower)."),t.currentStage=8)}if(8===o){if(!e.controller||e.controller.level<3)return;const o=e.find(FIND_MY_SPAWNS)[0];if(!o)return;if(!(e.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_TOWER}}).length>0||t.plannedStructures.some(t=>t.pos.roomName===e.name&&t.structureType===STRUCTURE_TOWER))){const n=[{dx:0,dy:-3},{dx:0,dy:3},{dx:-3,dy:0},{dx:3,dy:0}];for(const s of n){const n=new RoomPosition(o.pos.x+s.dx,o.pos.y+s.dy,e.name);if(e.getTerrain().get(n.x,n.y)!==TERRAIN_MASK_WALL&&!t.plannedStructures.some(e=>e.pos.x===n.x&&e.pos.y===n.y)&&(0,r.addPlannedStructure)(t.plannedStructures,n,STRUCTURE_TOWER,"to_build",e))break}}}};const r=o(623)},551(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.manageRemoteMining=function(e){Memory.remoteMining||(Memory.remoteMining={});const t=Game.map.describeExits(e.name);t&&Object.values(t).forEach(e=>{Memory.remoteMining[e]||(Memory.remoteMining[e]={sources:[],reserverNeeded:!1,isHostile:!1,lastScouted:0})})},t.getRemoteSpawnRequest=function(e){if(!Memory.remoteMining)return null;for(const t in Memory.remoteMining){const o=Memory.remoteMining[t],r=_.filter(Game.creeps,e=>e.memory.targetRoom===t);if(Game.time-o.lastScouted>1e4&&_.filter(r,e=>"scout"===e.memory.role).length<1)return{role:"scout",targetRoom:t};if(o.isHostile||0===o.sources.length)continue;const n=_.filter(r,e=>"remoteHarvester"===e.memory.role);if(n.length<o.sources.length)return{role:"remoteHarvester",targetRoom:t};if(o.reserverNeeded&&e.controller&&e.controller.level>=3&&_.filter(r,e=>"reserver"===e.memory.role).length<1)return{role:"reserver",targetRoom:t};if(_.filter(r,e=>"remoteCarrier"===e.memory.role).length<2*n.length)return{role:"remoteCarrier",targetRoom:t}}return null}},119(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runBuilder=function(e){if(!(0,r.handleDefensiveState)(e)){if(e.memory.building&&0===e.store[RESOURCE_ENERGY]&&(e.memory.building=!1,delete e.memory.targetId),e.memory.building||0!==e.store.getFreeCapacity()||(e.memory.building=!0,delete e.memory.targetId),e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&0!==(0,r.getEnergyAmount)(t)||delete e.memory.targetId}if(e.memory.building){if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_MY_CONSTRUCTION_SITES);t&&(e.memory.targetId=t.id)}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t?e.build(t)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"üî®"):delete e.memory.targetId}else e.upgradeController(e.room.controller)===ERR_NOT_IN_RANGE?e.moveTo(e.room.controller,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"‚ö°")}else{if(!e.memory.targetId){const t=e.room.storage;if(t&&t.store[RESOURCE_ENERGY]>0&&(0,r.isTargetAvailable)(e,t)&&(e.memory.targetId=t.id),!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.store[RESOURCE_ENERGY]>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_DROPPED_RESOURCES,{filter:t=>t.resourceType===RESOURCE_ENERGY&&t.amount>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&((t instanceof Resource?e.pickup(t):e.withdraw(t,RESOURCE_ENERGY))===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"üì¶"))}else(0,r.sayAction)(e,"üí§")}}};const r=o(623)},978(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runHarvester=function(e){if((0,r.handleDefensiveState)(e))return;const t=e.room;if(!e.memory.sourceId){const o=t.find(FIND_SOURCES),n=_.filter(o,e=>(0,r.isSourceSafe)(e));if(n.length>0){const o=_.filter(Game.creeps,o=>o.room.name===t.name&&"harvester"===o.memory.role&&o.name!==e.name);for(const t of n)if(_.filter(o,e=>e.memory.sourceId===t.id).length<2){e.memory.sourceId=t.id;break}}}const o=Game.getObjectById(e.memory.sourceId);if(o)if(e.store.getFreeCapacity()>0)e.harvest(o)===ERR_NOT_IN_RANGE?e.moveTo(o,{visualizePathStyle:{stroke:"#ffaa00"}}):(0,r.sayAction)(e,"‚õèÔ∏è");else if(0===_.filter(Game.creeps,e=>e.room.name===t.name&&"supplier"===e.memory.role&&!e.spawning).length){const o=e.pos.findClosestByPath(FIND_MY_STRUCTURES,{filter:e=>(e.structureType===STRUCTURE_SPAWN||e.structureType===STRUCTURE_EXTENSION)&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0});o?e.transfer(o,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(o,{visualizePathStyle:{stroke:"#ffffff"}}):(0,r.sayAction)(e,"üì•"):e.upgradeController(t.controller)===ERR_NOT_IN_RANGE?e.moveTo(t.controller):(0,r.sayAction)(e,"‚ö°")}else{const t=e.pos.findInRange(FIND_MY_STRUCTURES,3,{filter:e=>e.structureType===STRUCTURE_LINK&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0})[0];if(t)e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t):(0,r.sayAction)(e,"üì•");else{const t=e.pos.findInRange(FIND_STRUCTURES,3,{filter:e=>e.structureType===STRUCTURE_CONTAINER&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0})[0];t?e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t):(0,r.sayAction)(e,"üì•"):((0,r.sayAction)(e,"üì¶"),e.drop(RESOURCE_ENERGY))}}else delete e.memory.sourceId};const r=o(623)},926(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runRemoteCarrier=function(e){if(e.memory.targetRoom&&e.memory.homeRoom)if(0===e.store.getUsedCapacity())if(e.room.name!==e.memory.targetRoom)(0,r.sayAction)(e,"üèÉ"),(0,r.travelToRoom)(e,e.memory.targetRoom);else{const t=e.pos.findClosestByRange(FIND_DROPPED_RESOURCES,{filter:e=>e.resourceType===RESOURCE_ENERGY&&e.amount>50});t&&(e.pickup(t)===ERR_NOT_IN_RANGE?e.moveTo(t):(0,r.sayAction)(e,"üì¶"))}else if(e.room.name!==e.memory.homeRoom)(0,r.sayAction)(e,"üí∞"),(0,r.travelToRoom)(e,e.memory.homeRoom);else{const t=e.pos.findClosestByPath(FIND_MY_STRUCTURES,{filter:e=>(e.structureType===STRUCTURE_STORAGE||e.structureType===STRUCTURE_SPAWN||e.structureType===STRUCTURE_EXTENSION)&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0});t&&(e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t):(0,r.sayAction)(e,"üì•"))}};const r=o(623)},292(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runRemoteHarvester=function(e){if(e.memory.targetRoom)if(e.room.name!==e.memory.targetRoom)(0,r.sayAction)(e,"üöö"),(0,r.travelToRoom)(e,e.memory.targetRoom);else{if(!e.memory.sourceId){const t=e.room.find(FIND_SOURCES);t.length>0&&(e.memory.sourceId=t[0].id)}const t=Game.getObjectById(e.memory.sourceId);t&&(e.harvest(t)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"}}):(0,r.sayAction)(e,"‚õèÔ∏è"))}};const r=o(623)},648(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runReserver=function(e){if(e.memory.targetRoom)if(e.room.name!==e.memory.targetRoom)(0,r.sayAction)(e,"üöÄ"),(0,r.travelToRoom)(e,e.memory.targetRoom);else{const t=e.room.controller;t&&(e.reserveController(t)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"}}):(0,r.sayAction)(e,"üîí"))}};const r=o(623)},70(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runScout=function(e){const t=e.memory.targetRoom;if(t){if(e.room.name===t){if(0===e.pos.x)return void e.move(RIGHT);if(49===e.pos.x)return void e.move(LEFT);if(0===e.pos.y)return void e.move(BOTTOM);if(49===e.pos.y)return void e.move(TOP);(0,r.sayAction)(e,"‚úÖ"),Memory.remoteMining||(Memory.remoteMining={});const t=e.room.find(FIND_SOURCES).map(e=>e.id),o=e.room.controller,n=!(!o||!o.owner||o.my);return void(Memory.remoteMining[e.room.name]={sources:t,reserverNeeded:!!o&&!o.owner,isHostile:n,lastScouted:Game.time})}(0,r.sayAction)(e,"üî≠"),(0,r.travelToRoom)(e,t)}};const r=o(623)},594(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runSupplier=function(e){if((0,r.handleDefensiveState)(e))return;const t=e.room;if(0!==e.getActiveBodyparts(WORK)){if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&0!==(0,r.getEnergyAmount)(t)?(0===e.store.getFreeCapacity()&&(t instanceof Resource||t instanceof StructureContainer||t instanceof StructureLink||t instanceof StructureStorage)||0===e.store.getUsedCapacity())&&delete e.memory.targetId:delete e.memory.targetId}if(0===e.store.getUsedCapacity()){if(!e.memory.targetId){const o=t.find(FIND_SOURCES),n=t.find(FIND_STRUCTURES,{filter:t=>(t.structureType===STRUCTURE_CONTAINER||t.structureType===STRUCTURE_LINK)&&o.some(e=>t.pos.inRangeTo(e,3))&&(0,r.isTargetAvailable)(e,t)});if(n.length>0){const t=e.pos.findClosestByPath(n);t&&(e.memory.targetId=t.id)}if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_DROPPED_RESOURCES,{filter:t=>t.resourceType===RESOURCE_ENERGY&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}!e.memory.targetId&&t.storage&&(0,r.isTargetAvailable)(e,t.storage)&&t.storage.store[RESOURCE_ENERGY]>500&&(e.memory.targetId=t.storage.id)}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&((t instanceof Resource?e.pickup(t):e.withdraw(t,RESOURCE_ENERGY))===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"üì¶"))}else(0,r.sayAction)(e,"üí§")}else{if(!e.memory.targetId){let o=e.pos.findClosestByPath(FIND_MY_STRUCTURES,{filter:e=>(e.structureType===STRUCTURE_SPAWN||e.structureType===STRUCTURE_EXTENSION)&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0});if(!o){const r=t.find(FIND_SOURCES);o=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:e=>{const t=e.structureType===STRUCTURE_CONTAINER,o=!r.some(t=>e.pos.inRangeTo(t,3));return t&&o&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0}})}o&&(e.memory.targetId=o.id)}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&t.store&&t.store.getFreeCapacity(RESOURCE_ENERGY)>0?e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"üì•"):delete e.memory.targetId}else{const o=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:e=>e.hits<e.hitsMax&&e.structureType!==STRUCTURE_WALL&&e.structureType!==STRUCTURE_RAMPART});if(o)return void(e.repair(o)===ERR_NOT_IN_RANGE?e.moveTo(o):(0,r.sayAction)(e,"üîß"));const n=e.pos.findClosestByPath(FIND_MY_CONSTRUCTION_SITES);if(n)return void(e.build(n)===ERR_NOT_IN_RANGE?e.moveTo(n):(0,r.sayAction)(e,"üî®"));e.upgradeController(t.controller)===ERR_NOT_IN_RANGE?e.moveTo(t.controller):(0,r.sayAction)(e,"‚ö°")}}}else e.suicide()};const r=o(623)},180(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runUpgrader=function(e){if(!(0,r.handleDefensiveState)(e)){if(e.memory.upgrading&&0===e.store[RESOURCE_ENERGY]&&(e.memory.upgrading=!1,delete e.memory.targetId),e.memory.upgrading||0!==e.store.getFreeCapacity()||(e.memory.upgrading=!0,delete e.memory.targetId),e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&0!==(0,r.getEnergyAmount)(t)||delete e.memory.targetId}if(e.memory.upgrading)e.upgradeController(e.room.controller)===ERR_NOT_IN_RANGE?e.moveTo(e.room.controller,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"‚ö°");else{if(!e.memory.targetId){const t=e.room.controller.pos.findInRange(FIND_STRUCTURES,3,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.store[RESOURCE_ENERGY]>0&&(0,r.isTargetAvailable)(e,t)})[0];if(t&&(e.memory.targetId=t.id),!e.memory.targetId&&e.room.storage&&(0,r.isTargetAvailable)(e,e.room.storage)&&e.room.storage.store[RESOURCE_ENERGY]>0&&(e.memory.targetId=e.room.storage.id),!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.store[RESOURCE_ENERGY]>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_DROPPED_RESOURCES,{filter:t=>t.resourceType===RESOURCE_ENERGY&&t.amount>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&((t instanceof Resource?e.pickup(t):e.withdraw(t,RESOURCE_ENERGY))===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"üì¶"))}else{if(e.room.controller.level<=2){const t=e.pos.findClosestByPath(FIND_SOURCES,{filter:e=>e.energy>0});if(t)return void(e.harvest(t)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"‚õèÔ∏è"))}(0,r.sayAction)(e,"üí§")}}}};const r=o(623)},623(e,t){function o(e,t){return!(!e||!e.roomName||e.x<0||e.y<0||e.x>=50||e.y>=50)&&t.getTerrain().get(e.x,e.y)!==TERRAIN_MASK_WALL}function r(e){return e?e.store?e.store.getUsedCapacity(RESOURCE_ENERGY):e.amount?e.amount:0:0}function n(e,t){e.memory.lastAction!==t&&(e.say(t,!1),e.memory.lastAction=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.isTerrainValidForRoad=o,t.addPlannedStructure=function(e,t,r,n="to_build",s){return!e.some(e=>e.pos.x===t.x&&e.pos.y===t.y&&e.structureType===r)&&!!o(t,s)&&(e.push({pos:t,structureType:r,status:n}),!0)},t.findClosestAnchor=function(e,t){if(0===t.length)return null;let o=null,r=1/0;for(const n of t){const t=e.getRangeTo(n);t<r&&(r=t,o=n)}return o},t.isSourceSafe=function(e){return!(e.pos.findInRange(FIND_HOSTILE_CREEPS,10).length>0)&&!(e.pos.findInRange(FIND_HOSTILE_STRUCTURES,10,{filter:e=>e.owner&&"Invader"!==e.owner.username&&"Source Keeper"!==e.owner.username}).length>0)},t.generateBody=function(e,t){let o=[];if("harvester"===e||"remoteHarvester"===e){o.push(CARRY),o.push(MOVE);let e=t-100,r=Math.floor(e/100);r>6&&(r=6),r<1&&(r=1);for(let e=0;e<r;e++)o.push(WORK)}else if("supplier"===e||"remoteCarrier"===e){o.push(WORK);let e=t-100,r=Math.floor(e/100);r>15&&(r=15),r<1&&(r=1);for(let e=0;e<r;e++)o.push(CARRY),o.push(MOVE)}else if("reserver"===e){let e=Math.floor(t/650);e>2&&(e=2),e<1&&(e=1);for(let t=0;t<e;t++)o.push(CLAIM),o.push(MOVE)}else if("scout"===e)o=[MOVE];else{let e=Math.floor(t/200);e>15&&(e=15),e<1&&(e=1);for(let t=0;t<e;t++)o.push(WORK),o.push(CARRY),o.push(MOVE)}return o},t.getEnergyAmount=r,t.isTargetAvailable=function(e,t){if(!t)return!1;let o=r(t);if(o<=0)return!1;const n=_.filter(Game.creeps,o=>o.room.name===e.room.name&&o.id!==e.id&&o.memory.targetId===t.id);let s=0;for(const e of n)s+=e.store.getFreeCapacity(RESOURCE_ENERGY);return o-s>0},t.handleDefensiveState=function(e){const t=e.pos.findInRange(FIND_HOSTILE_CREEPS,5);if(t.length>0){n(e,"üèÉüí®"),delete e.memory.targetId,"harvester"===e.memory.role&&delete e.memory.sourceId;const o=t.map(e=>({pos:e.pos,range:10})),r=PathFinder.search(e.pos,o,{flee:!0,maxRooms:1,plainCost:2,swampCost:10,maxOps:500}).path;if(r.length>0)e.moveByPath(r);else{const o=e.pos.findClosestByRange(t);if(o){const t=(e.pos.getDirectionTo(o)+4)%8||8;e.move(t)}}return!0}return!1},t.sayAction=n,t.travelToRoom=function(e,t){if(e.room.name===t)return!1;const o=e.room.findExitTo(t);if(o!==ERR_NO_PATH&&o!==ERR_INVALID_ARGS){const t=e.pos.findClosestByRange(o);if(t)return e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"},reusePath:20}),!0}return!1}}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.loop=void 0;const t=o(77),n=o(551),s=o(978),a=o(594),i=o(119),m=o(180),l=o(70),u=o(648),R=o(292),c=o(926),d=o(623);e.loop=function(){for(const e in Memory.creeps)Game.creeps[e]||delete Memory.creeps[e];const e=Object.values(Game.spawns)[0];if(!e)return;const o=e.room;if(Memory.planning&&Memory.planning.plannedStructures)for(const e of Memory.planning.plannedStructures)if("built"!==e.status&&Game.rooms[e.pos.roomName]){const t=new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName);if(t.lookFor(LOOK_STRUCTURES).some(t=>t.structureType===e.structureType)){e.status="built";continue}e.status=t.lookFor(LOOK_CONSTRUCTION_SITES).length>0?"building":"to_build"}if((0,t.planStructures)(o),(0,n.manageRemoteMining)(o),Memory.planning&&Memory.planning.plannedStructures){const e=Memory.planning.plannedStructures.filter(e=>"to_build"===e.status);for(const t of e){const e=Game.rooms[t.pos.roomName];e&&e.createConstructionSite(t.pos.x,t.pos.y,t.structureType)}}const r=o.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_TOWER}});for(const e of r){const t=e.pos.findClosestByRange(FIND_HOSTILE_CREEPS);if(t)e.attack(t);else{const t=e.pos.findClosestByRange(FIND_STRUCTURES,{filter:e=>e.hits<e.hitsMax&&e.structureType!==STRUCTURE_WALL&&e.structureType!==STRUCTURE_RAMPART});t&&e.repair(t)}}if(!e.spawning){const t=_.filter(Game.creeps,e=>e.room.name===o.name||e.memory.homeRoom===o.name),r=_.filter(t,e=>"harvester"===e.memory.role),s=_.filter(t,e=>"supplier"===e.memory.role),a=_.filter(t,e=>"builder"===e.memory.role),i=_.filter(t,e=>"upgrader"===e.memory.role),m=o.find(FIND_SOURCES),l=_.filter(m,e=>(0,d.isSourceSafe)(e)),u=o.controller?o.controller.level:1,R=o.find(FIND_MY_CONSTRUCTION_SITES).length>0,c=2*l.length,f=Math.max(1,r.length+1),p=R?u<=2?2:1:0,y=u<=3?2:1,T=(0,n.getRemoteSpawnRequest)(o);let E,S=null;if(r.length<l.length?S="harvester":s.length<1?S="supplier":i.length<1?S="upgrader":T&&"scout"===T.role?(S="scout",E=T.targetRoom):r.length<c?S="harvester":a.length<p?S="builder":T?(S=T.role,E=T.targetRoom):s.length<f?S="supplier":i.length<y&&(S="upgrader"),S){const t=0===r.length?o.energyAvailable:o.energyCapacityAvailable,n=(0,d.generateBody)(S,t);let s=0;for(const e of n)s+=BODYPART_COST[e];if(o.energyAvailable>=s){const t=S.charAt(0).toUpperCase()+S.slice(1)+Game.time;e.spawnCreep(n,t,{memory:{role:S,targetRoom:E,homeRoom:o.name}})}}}for(const e in Game.creeps){const t=Game.creeps[e];if(!t.spawning)switch(t.memory.role){case"harvester":(0,s.runHarvester)(t);break;case"builder":(0,i.runBuilder)(t);break;case"supplier":(0,a.runSupplier)(t);break;case"upgrader":(0,m.runUpgrader)(t);break;case"scout":(0,l.runScout)(t);break;case"reserver":(0,u.runReserver)(t);break;case"remoteHarvester":(0,R.runRemoteHarvester)(t);break;case"remoteCarrier":(0,c.runRemoteCarrier)(t)}}}})();var n=exports;for(var s in r)n[s]=r[s];r.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();