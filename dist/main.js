(()=>{"use strict";var e={77(e,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.planStructures=function(e){Memory.planning||(Memory.planning={plannedStructures:[],spawnSquareRoadAnchorPositions:[],currentStage:1}),void 0===Memory.planning.currentStage&&(Memory.planning.currentStage=1),Memory.planning.plannedStructures||(Memory.planning.plannedStructures=[]),Memory.planning.spawnSquareRoadAnchorPositions||(Memory.planning.spawnSquareRoadAnchorPositions=[]);const r=Memory.planning.currentStage;if(console.log(`Planner Stage: ${r}`),1===r){const r=e.find(FIND_MY_SPAWNS);if(r.length>0){const n=r[0],o=[{dx:-2,dy:0},{dx:2,dy:0},{dx:0,dy:-2},{dx:0,dy:2}];let s=0;for(const r of o){const o=new RoomPosition(n.pos.x+r.dx,n.pos.y+r.dy,e.name);(0,t.addPlannedStructure)(Memory.planning.plannedStructures,o,STRUCTURE_ROAD,"to_build",e)&&(Memory.planning.spawnSquareRoadAnchorPositions.push(o),s++)}s>0&&console.log(`Planner: Stage 1 - Planned ${s} roads.`)}const n=Memory.planning.plannedStructures.filter(e=>"to_build"===e.status).length,o=e.find(FIND_MY_CONSTRUCTION_SITES,{filter:e=>e.structureType===STRUCTURE_ROAD}).length;0===n&&0===o&&Memory.planning.spawnSquareRoadAnchorPositions.length>0&&(console.log("Planner: Stage 1 Complete. Advancing to Stage 2."),Memory.planning.currentStage=2)}};const t=n(623)},119(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.runBuilder=function(e){if(e.memory.building&&0===e.store[RESOURCE_ENERGY]&&(e.memory.building=!1),e.memory.building||0!==e.store.getFreeCapacity()||(e.memory.building=!0),e.memory.building){const r=e.pos.findClosestByPath(FIND_MY_CONSTRUCTION_SITES);r&&e.build(r)===ERR_NOT_IN_RANGE&&e.moveTo(r)}else{const r=e.pos.findClosestByPath(FIND_SOURCES);r&&e.harvest(r)===ERR_NOT_IN_RANGE&&e.moveTo(r)}}},978(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.runHarvester=function(e){if(e.store.getFreeCapacity()>0){const r=e.pos.findClosestByPath(FIND_SOURCES);r&&e.harvest(r)===ERR_NOT_IN_RANGE&&e.moveTo(r)}else{const r=e.pos.findClosestByPath(FIND_MY_SPAWNS);r&&e.transfer(r,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE&&e.moveTo(r)}}},594(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.runSupplier=function(e){if(0===e.store.getUsedCapacity()){const r=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:e=>e.structureType===STRUCTURE_CONTAINER&&e.store[RESOURCE_ENERGY]>0});r&&e.withdraw(r,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE&&e.moveTo(r)}else{const r=e.pos.findClosestByPath(FIND_MY_STRUCTURES,{filter:e=>(e.structureType===STRUCTURE_SPAWN||e.structureType===STRUCTURE_EXTENSION)&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0});r&&e.transfer(r,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE&&e.moveTo(r)}}},623(e,r){function n(e,r){if(!e||!e.roomName||e.x<0||e.y<0||e.x>=50||e.y>=50)return!1;if("wall"===Game.map.getTerrainAt(e.x,e.y,r.name))return!1;const n=r.lookAt(e);for(const e of n){if(e.structure&&e.structure.structureType!==STRUCTURE_ROAD)return!1;if(e.constructionSite&&e.constructionSite.structureType!==STRUCTURE_ROAD)return!1}return!0}Object.defineProperty(r,"__esModule",{value:!0}),r.isTerrainValidForRoad=n,r.addPlannedStructure=function(e,r,t,o="to_build",s){return!e.some(e=>e.pos.x===r.x&&e.pos.y===r.y&&e.structureType===t)&&!!n(r,s)&&(e.push({pos:r,structureType:t,status:o}),!0)},r.findClosestAnchor=function(e,r){if(0===r.length)return null;let n=null,t=1/0;for(const o of r){const r=e.getRangeTo(o);r<t&&(t=r,n=o)}return n}}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var s=r[t]={exports:{}};return e[t](s,s.exports,n),s.exports}var t={};(()=>{var e=t;Object.defineProperty(e,"__esModule",{value:!0}),e.loop=void 0,console.log("--- GEMINI DEPLOY TEST: CÃ³digo Atualizado v4 ---");const r=n(77),o=n(978),s=n(594),a=n(119);e.loop=function(){for(const e in Memory.creeps)Game.creeps[e]||delete Memory.creeps[e];const e=Object.values(Game.rooms)[0];if(!e)return;if((0,r.planStructures)(e),Memory.planning&&Memory.planning.plannedStructures){const r=Memory.planning.plannedStructures.filter(e=>"to_build"===e.status);r.length>0&&console.log(`Main: Found ${r.length} structures pending construction.`);for(const n of r){const r=e.createConstructionSite(n.pos.x,n.pos.y,n.structureType);r===OK?(n.status="building",console.log(`Main: Successfully created CS for ${n.structureType} at ${n.pos.x},${n.pos.y}`)):console.log(`Main: Failed to create CS for ${n.structureType} at ${n.pos.x},${n.pos.y}. Error: ${r}`)}}const n=e.find(FIND_MY_SPAWNS)[0];if(n&&!n.spawning&&e.energyAvailable>=200){const r=_.filter(Game.creeps,r=>r.room.name===e.name);_.filter(r,e=>"harvester"===e.memory.role).length<2?n.spawnCreep([WORK,CARRY,MOVE],"Harvester"+Game.time,{memory:{role:"harvester"}}):_.filter(r,e=>"builder"===e.memory.role).length<2&&e.find(FIND_MY_CONSTRUCTION_SITES).length>0&&n.spawnCreep([WORK,CARRY,MOVE],"Builder"+Game.time,{memory:{role:"builder"}})}for(const e in Game.creeps){const r=Game.creeps[e];"harvester"===r.memory.role&&(0,o.runHarvester)(r),"builder"===r.memory.role&&(0,a.runBuilder)(r),"supplier"===r.memory.role&&(0,s.runSupplier)(r)}}})();var o=exports;for(var s in t)o[s]=t[s];t.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();