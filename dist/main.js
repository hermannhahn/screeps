(()=>{"use strict";var e={77(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.planStructures=function(e){Memory.planning||(Memory.planning={plannedStructures:[],spawnSquareRoadAnchorPositions:[],currentStage:1});const t=Memory.planning;void 0===t.currentStage&&(t.currentStage=1),t.plannedStructures||(t.plannedStructures=[]),t.spawnSquareRoadAnchorPositions||(t.spawnSquareRoadAnchorPositions=[]);const o=t.currentStage,n=e.find(FIND_MY_CONSTRUCTION_SITES),s=e.find(FIND_SOURCES),a=s.filter(e=>!(0,r.isSourceSafe)(e));if(a.length>0){t.plannedStructures=t.plannedStructures.filter(e=>{const t=new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName);return!a.some(e=>t.inRangeTo(e,10))});for(const e of n)a.some(t=>e.pos.inRangeTo(t,10))&&e.remove()}if(1===o){const o=e.find(FIND_MY_SPAWNS);if(o.length>0){const n=o[0],s=[{dx:-2,dy:0},{dx:2,dy:0},{dx:0,dy:-2},{dx:0,dy:2},{dx:-1,dy:-1},{dx:1,dy:-1},{dx:-1,dy:1},{dx:1,dy:1}];for(const o of s){const s=new RoomPosition(n.pos.x+o.dx,n.pos.y+o.dy,e.name);(0,r.addPlannedStructure)(t.plannedStructures,s,STRUCTURE_ROAD,"to_build",e)&&t.spawnSquareRoadAnchorPositions.push(s)}}const s=t.plannedStructures.filter(e=>e.structureType===STRUCTURE_ROAD&&t.spawnSquareRoadAnchorPositions.some(t=>t.x===e.pos.x&&t.y===e.pos.y));s.length>0&&s.every(e=>"built"===e.status)&&0===n.length&&(console.log("Planner: Stage 1 Complete. Advancing to Stage 2."),t.currentStage=2)}if(2===o){const o=e.find(FIND_MY_SPAWNS);if(0===o.length)return;const s=o[0],a=5;if(e.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_EXTENSION}}).length+t.plannedStructures.filter(e=>e.structureType===STRUCTURE_EXTENSION).length<a)for(const o of t.spawnSquareRoadAnchorPositions){const n=new RoomPosition(o.x,o.y,o.roomName);if(t.plannedStructures.filter(e=>e.structureType===STRUCTURE_EXTENSION).length>=a)break;const i=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(const o of i){const i=new RoomPosition(n.x+o.dx,n.y+o.dy,e.name);if(e.getTerrain().get(i.x,i.y)!==TERRAIN_MASK_WALL&&!i.isEqualTo(s.pos)&&!t.plannedStructures.some(e=>e.pos.x===i.x&&e.pos.y===i.y)&&(0,r.addPlannedStructure)(t.plannedStructures,i,STRUCTURE_EXTENSION,"to_build",e)&&t.plannedStructures.filter(e=>e.structureType===STRUCTURE_EXTENSION).length>=a)break}}const i=t.plannedStructures.filter(e=>e.structureType===STRUCTURE_EXTENSION);i.length>=5&&i.every(e=>"built"===e.status)&&0===n.length&&(console.log("Planner: Stage 2 Complete. Advancing to Stage 3."),t.currentStage=3)}if(3===o){const o=s.filter(e=>(0,r.isSourceSafe)(e)),a=t.spawnSquareRoadAnchorPositions.map(e=>new RoomPosition(e.x,e.y,e.roomName));if(a.length>0){let n=!1;for(const s of o)if(!t.plannedStructures.some(e=>{const t=new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName);return e.structureType===STRUCTURE_ROAD&&t.isNearTo(s.pos)})){const o=(0,r.findClosestAnchor)(s.pos,a);if(o){const a=PathFinder.search(s.pos,{pos:o,range:1},{plainCost:2,swampCost:10,roomCallback:t=>{let o=new PathFinder.CostMatrix;return e.find(FIND_STRUCTURES).forEach(e=>{e.structureType!==STRUCTURE_ROAD&&o.set(e.pos.x,e.pos.y,255)}),o}}).path;for(const o of a)(0,r.addPlannedStructure)(t.plannedStructures,o,STRUCTURE_ROAD,"to_build",e)&&(n=!0)}}n&&console.log("Planner Stage 3: New road positions added.")}const i=t.plannedStructures.filter(e=>e.structureType===STRUCTURE_ROAD&&!t.spawnSquareRoadAnchorPositions.some(t=>t.x===e.pos.x&&t.y===e.pos.y));i.length>0&&i.every(e=>"built"===e.status)&&0===n.length&&(console.log("Planner: Stage 3 Complete. Advancing to Stage 4."),t.currentStage=4)}if(4===o){let o=!1;const a=s.filter(e=>(0,r.isSourceSafe)(e));for(const n of a)if(!(e.find(FIND_STRUCTURES,{filter:e=>e.structureType===STRUCTURE_CONTAINER&&e.pos.inRangeTo(n,2)}).length>0||t.plannedStructures.some(e=>e.structureType===STRUCTURE_CONTAINER&&new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName).inRangeTo(n,2)))){const s=t.plannedStructures.find(e=>e.structureType===STRUCTURE_ROAD&&new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName).isNearTo(n.pos));if(s){const n=new RoomPosition(s.pos.x,s.pos.y,s.pos.roomName);(0,r.addPlannedStructure)(t.plannedStructures,n,STRUCTURE_CONTAINER,"to_build",e)&&(o=!0)}}if(e.controller&&!(e.find(FIND_STRUCTURES,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.pos.inRangeTo(e.controller,3)}).length>0||t.plannedStructures.some(t=>t.structureType===STRUCTURE_CONTAINER&&new RoomPosition(t.pos.x,t.pos.y,t.pos.roomName).inRangeTo(e.controller,3)))){const n=[{dx:1,dy:1},{dx:-1,dy:1},{dx:1,dy:-1},{dx:-1,dy:-1},{dx:2,dy:0},{dx:-2,dy:0},{dx:0,dy:2},{dx:0,dy:-2}];for(const s of n){const n=new RoomPosition(e.controller.pos.x+s.dx,e.controller.pos.y+s.dy,e.name);if(e.getTerrain().get(n.x,n.y)!==TERRAIN_MASK_WALL&&!t.plannedStructures.some(e=>e.pos.x===n.x&&e.pos.y===n.y)&&(0,r.addPlannedStructure)(t.plannedStructures,n,STRUCTURE_CONTAINER,"to_build",e)){o=!0;break}}}t.plannedStructures.filter(e=>e.structureType===STRUCTURE_TOWER);const i=e.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_TOWER}});for(const n of i)if(!(n.pos.findInRange(FIND_STRUCTURES,1,{filter:{structureType:STRUCTURE_CONTAINER}}).length>0||t.plannedStructures.some(e=>e.structureType===STRUCTURE_CONTAINER&&new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName).isNearTo(n.pos)))){const s=[{dx:0,dy:1},{dx:0,dy:-1},{dx:1,dy:0},{dx:-1,dy:0}];for(const a of s){const s=new RoomPosition(n.pos.x+a.dx,n.pos.y+a.dy,e.name);if(e.getTerrain().get(s.x,s.y)!==TERRAIN_MASK_WALL&&!t.plannedStructures.some(e=>e.pos.x===s.x&&e.pos.y===s.y)&&(0,r.addPlannedStructure)(t.plannedStructures,s,STRUCTURE_CONTAINER,"to_build",e)){o=!0;break}}}const l=t.plannedStructures.filter(e=>e.structureType===STRUCTURE_CONTAINER);l.length>0&&l.every(e=>"built"===e.status)&&0===n.length&&(console.log("Planner: Stage 4 Complete. Advancing to Stage 5."),t.currentStage=5)}if(5===o){const o=e.controller;if(!o)return;const s=t.spawnSquareRoadAnchorPositions.map(e=>new RoomPosition(e.x,e.y,e.roomName)),a=(0,r.findClosestAnchor)(o.pos,s);if(a){const n=PathFinder.search(o.pos,{pos:a,range:1},{plainCost:2,swampCost:10}).path;for(const o of n)(0,r.addPlannedStructure)(t.plannedStructures,o,STRUCTURE_ROAD,"to_build",e)}0===t.plannedStructures.filter(e=>"built"!==e.status&&!t.spawnSquareRoadAnchorPositions.some(t=>t.x===e.pos.x&&t.y===e.pos.y)).length&&0===n.length&&(console.log("Planner: Stage 5 Complete. Advancing to Stage 6."),t.currentStage=6)}if(6===o){if(!e.controller||e.controller.level<3)return;const o=e.find(FIND_MY_SPAWNS);if(0===o.length)return;const s=o[0];if(!(e.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_TOWER}}).length>0||t.plannedStructures.some(e=>e.structureType===STRUCTURE_TOWER))){const o=[{dx:0,dy:-3},{dx:0,dy:3},{dx:-3,dy:0},{dx:3,dy:0}];for(const n of o){const o=new RoomPosition(s.pos.x+n.dx,s.pos.y+n.dy,e.name);if(e.getTerrain().get(o.x,o.y)!==TERRAIN_MASK_WALL&&!t.plannedStructures.some(e=>e.pos.x===o.x&&e.pos.y===o.y)&&(0,r.addPlannedStructure)(t.plannedStructures,o,STRUCTURE_TOWER,"to_build",e)){console.log(`Planner: Planned first Tower at ${o.x},${o.y}`);break}}}const a=t.plannedStructures.find(e=>e.structureType===STRUCTURE_TOWER);a&&"built"===a.status&&0===n.length&&(console.log("Planner: Stage 6 Complete. Advancing to Stage 7."),t.currentStage=7)}};const r=o(623)},119(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runBuilder=function(e){if(!(0,r.handleDefensiveState)(e)){if(e.memory.building&&0===e.store[RESOURCE_ENERGY]&&(e.memory.building=!1,delete e.memory.targetId),e.memory.building||0!==e.store.getFreeCapacity()||(e.memory.building=!0,delete e.memory.targetId),e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&0!==(0,r.getEnergyAmount)(t)||delete e.memory.targetId}if(e.memory.building){if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_MY_CONSTRUCTION_SITES);t&&(e.memory.targetId=t.id)}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t?e.build(t)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"üî®"):delete e.memory.targetId}else e.upgradeController(e.room.controller)===ERR_NOT_IN_RANGE?e.moveTo(e.room.controller,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"‚ö°")}else{if(!e.memory.targetId){const t=e.room.storage;if(t&&t.store[RESOURCE_ENERGY]>0&&(0,r.isTargetAvailable)(e,t)&&(e.memory.targetId=t.id),!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.store[RESOURCE_ENERGY]>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_DROPPED_RESOURCES,{filter:t=>t.resourceType===RESOURCE_ENERGY&&t.amount>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&((t instanceof Resource?e.pickup(t):e.withdraw(t,RESOURCE_ENERGY))===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"üì¶"))}else(0,r.sayAction)(e,"üí§")}}};const r=o(623)},978(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runHarvester=function(e){if((0,r.handleDefensiveState)(e))return;const t=e.room;if(!e.memory.sourceId){const o=t.find(FIND_SOURCES),n=_.filter(o,e=>(0,r.isSourceSafe)(e));if(n.length>0){const o=_.filter(Game.creeps,o=>o.room.name===t.name&&"harvester"===o.memory.role&&o.name!==e.name);for(const t of n)if(_.filter(o,e=>e.memory.sourceId===t.id).length<2){e.memory.sourceId=t.id;break}}}const o=Game.getObjectById(e.memory.sourceId);if(o)if(e.store.getFreeCapacity()>0)e.harvest(o)===ERR_NOT_IN_RANGE?e.moveTo(o,{visualizePathStyle:{stroke:"#ffaa00"}}):(0,r.sayAction)(e,"‚õèÔ∏è");else if(0===_.filter(Game.creeps,e=>e.room.name===t.name&&"supplier"===e.memory.role&&!e.spawning).length){const o=e.pos.findClosestByPath(FIND_MY_STRUCTURES,{filter:e=>(e.structureType===STRUCTURE_SPAWN||e.structureType===STRUCTURE_EXTENSION)&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0});o?e.transfer(o,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(o,{visualizePathStyle:{stroke:"#ffffff"}}):(0,r.sayAction)(e,"üì•"):e.upgradeController(t.controller)===ERR_NOT_IN_RANGE?e.moveTo(t.controller):(0,r.sayAction)(e,"‚ö°")}else{const t=e.pos.findInRange(FIND_MY_STRUCTURES,3,{filter:e=>e.structureType===STRUCTURE_LINK&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0})[0];if(t)e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t):(0,r.sayAction)(e,"üì•");else{const t=e.pos.findInRange(FIND_STRUCTURES,3,{filter:e=>e.structureType===STRUCTURE_CONTAINER&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0})[0];t?e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t):(0,r.sayAction)(e,"üì•"):((0,r.sayAction)(e,"üì¶"),e.drop(RESOURCE_ENERGY))}}else delete e.memory.sourceId};const r=o(623)},594(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runSupplier=function(e){if((0,r.handleDefensiveState)(e))return;const t=e.room;if(0!==e.getActiveBodyparts(WORK)){if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&0!==(0,r.getEnergyAmount)(t)?(0===e.store.getFreeCapacity()&&(t instanceof Resource||t instanceof StructureContainer||t instanceof StructureLink||t instanceof StructureStorage)||0===e.store.getUsedCapacity())&&delete e.memory.targetId:delete e.memory.targetId}if(0===e.store.getUsedCapacity()){if(!e.memory.targetId){const o=t.find(FIND_SOURCES),n=t.find(FIND_STRUCTURES,{filter:t=>(t.structureType===STRUCTURE_CONTAINER||t.structureType===STRUCTURE_LINK)&&o.some(e=>t.pos.inRangeTo(e,3))&&(0,r.isTargetAvailable)(e,t)});if(n.length>0){const t=e.pos.findClosestByPath(n);t&&(e.memory.targetId=t.id)}if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_DROPPED_RESOURCES,{filter:t=>t.resourceType===RESOURCE_ENERGY&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}!e.memory.targetId&&t.storage&&(0,r.isTargetAvailable)(e,t.storage)&&t.storage.store[RESOURCE_ENERGY]>500&&(e.memory.targetId=t.storage.id)}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&((t instanceof Resource?e.pickup(t):e.withdraw(t,RESOURCE_ENERGY))===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"üì¶"))}else(0,r.sayAction)(e,"üí§")}else{if(!e.memory.targetId){let o=e.pos.findClosestByPath(FIND_MY_STRUCTURES,{filter:e=>(e.structureType===STRUCTURE_SPAWN||e.structureType===STRUCTURE_EXTENSION)&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0});if(!o){const r=t.find(FIND_SOURCES);o=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:e=>{const t=e.structureType===STRUCTURE_CONTAINER,o=!r.some(t=>e.pos.inRangeTo(t,3));return t&&o&&e.store.getFreeCapacity(RESOURCE_ENERGY)>0}})}o&&(e.memory.targetId=o.id)}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&t.store&&t.store.getFreeCapacity(RESOURCE_ENERGY)>0?e.transfer(t,RESOURCE_ENERGY)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"üì•"):delete e.memory.targetId}else{const o=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:e=>e.hits<e.hitsMax&&e.structureType!==STRUCTURE_WALL&&e.structureType!==STRUCTURE_RAMPART});if(o)return void(e.repair(o)===ERR_NOT_IN_RANGE?e.moveTo(o):(0,r.sayAction)(e,"üîß"));const n=e.pos.findClosestByPath(FIND_MY_CONSTRUCTION_SITES);if(n)return void(e.build(n)===ERR_NOT_IN_RANGE?e.moveTo(n):(0,r.sayAction)(e,"üî®"));e.upgradeController(t.controller)===ERR_NOT_IN_RANGE?e.moveTo(t.controller):(0,r.sayAction)(e,"‚ö°")}}}else e.suicide()};const r=o(623)},180(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),t.runUpgrader=function(e){if(!(0,r.handleDefensiveState)(e)){if(e.memory.upgrading&&0===e.store[RESOURCE_ENERGY]&&(e.memory.upgrading=!1,delete e.memory.targetId),e.memory.upgrading||0!==e.store.getFreeCapacity()||(e.memory.upgrading=!0,delete e.memory.targetId),e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&0!==(0,r.getEnergyAmount)(t)||delete e.memory.targetId}if(e.memory.upgrading)e.upgradeController(e.room.controller)===ERR_NOT_IN_RANGE?e.moveTo(e.room.controller,{visualizePathStyle:{stroke:"#ffffff"},reusePath:10}):(0,r.sayAction)(e,"‚ö°");else{if(!e.memory.targetId){const t=e.room.controller.pos.findInRange(FIND_STRUCTURES,3,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.store[RESOURCE_ENERGY]>0&&(0,r.isTargetAvailable)(e,t)})[0];if(t&&(e.memory.targetId=t.id),!e.memory.targetId&&e.room.storage&&(0,r.isTargetAvailable)(e,e.room.storage)&&e.room.storage.store[RESOURCE_ENERGY]>0&&(e.memory.targetId=e.room.storage.id),!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_STRUCTURES,{filter:t=>t.structureType===STRUCTURE_CONTAINER&&t.store[RESOURCE_ENERGY]>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}if(!e.memory.targetId){const t=e.pos.findClosestByPath(FIND_DROPPED_RESOURCES,{filter:t=>t.resourceType===RESOURCE_ENERGY&&t.amount>50&&(0,r.isTargetAvailable)(e,t)});t&&(e.memory.targetId=t.id)}}if(e.memory.targetId){const t=Game.getObjectById(e.memory.targetId);t&&((t instanceof Resource?e.pickup(t):e.withdraw(t,RESOURCE_ENERGY))===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"üì¶"))}else{if(e.room.controller.level<=2){const t=e.pos.findClosestByPath(FIND_SOURCES,{filter:e=>e.energy>0});if(t)return void(e.harvest(t)===ERR_NOT_IN_RANGE?e.moveTo(t,{visualizePathStyle:{stroke:"#ffaa00"},reusePath:10}):(0,r.sayAction)(e,"‚õèÔ∏è"))}(0,r.sayAction)(e,"üí§")}}}};const r=o(623)},623(e,t){function o(e,t){return!(!e||!e.roomName||e.x<0||e.y<0||e.x>=50||e.y>=50)&&t.getTerrain().get(e.x,e.y)!==TERRAIN_MASK_WALL}function r(e){return e?e.store?e.store.getUsedCapacity(RESOURCE_ENERGY):e.amount?e.amount:0:0}function n(e,t){e.memory.lastAction!==t&&(e.say(t,!1),e.memory.lastAction=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.isTerrainValidForRoad=o,t.addPlannedStructure=function(e,t,r,n="to_build",s){return!e.some(e=>e.pos.x===t.x&&e.pos.y===t.y&&e.structureType===r)&&!!o(t,s)&&(e.push({pos:t,structureType:r,status:n}),!0)},t.findClosestAnchor=function(e,t){if(0===t.length)return null;let o=null,r=1/0;for(const n of t){const t=e.getRangeTo(n);t<r&&(r=t,o=n)}return o},t.isSourceSafe=function(e){return!(e.pos.findInRange(FIND_HOSTILE_CREEPS,10).length>0)&&!(e.pos.findInRange(FIND_HOSTILE_STRUCTURES,10,{filter:e=>e.owner&&"Invader"!==e.owner.username&&"Source Keeper"!==e.owner.username}).length>0)},t.generateBody=function(e,t){let o=[];if("harvester"===e||"remoteHarvester"===e){o.push(CARRY),o.push(MOVE);let e=t-100,r=Math.floor(e/100);r>6&&(r=6),r<1&&(r=1);for(let e=0;e<r;e++)o.push(WORK)}else if("supplier"===e||"remoteCarrier"===e){o.push(WORK);let e=t-100,r=Math.floor(e/100);r>15&&(r=15),r<1&&(r=1);for(let e=0;e<r;e++)o.push(CARRY),o.push(MOVE)}else if("reserver"===e){let e=Math.floor(t/650);e>2&&(e=2),e<1&&(e=1);for(let t=0;t<e;t++)o.push(CLAIM),o.push(MOVE)}else if("scout"===e)o=[MOVE];else{let e=Math.floor(t/200);e>15&&(e=15),e<1&&(e=1);for(let t=0;t<e;t++)o.push(WORK),o.push(CARRY),o.push(MOVE)}return o},t.getEnergyAmount=r,t.isTargetAvailable=function(e,t){if(!t)return!1;let o=r(t);if(o<=0)return!1;const n=_.filter(Game.creeps,o=>o.room.name===e.room.name&&o.id!==e.id&&o.memory.targetId===t.id);let s=0;for(const e of n)s+=e.store.getFreeCapacity(RESOURCE_ENERGY);return o-s>0},t.handleDefensiveState=function(e){const t=e.pos.findInRange(FIND_HOSTILE_CREEPS,5);if(t.length>0){n(e,"üèÉüí®"),delete e.memory.targetId,"harvester"===e.memory.role&&delete e.memory.sourceId;const o=t.map(e=>({pos:e.pos,range:10})),r=PathFinder.search(e.pos,o,{flee:!0,maxRooms:1,plainCost:2,swampCost:10,maxOps:500}).path;if(r.length>0)e.moveByPath(r);else{const o=e.pos.findClosestByRange(t);if(o){const t=(e.pos.getDirectionTo(o)+4)%8||8;e.move(t)}}return!0}return!1},t.sayAction=n,t.travelToRoom=function(e,t){if(e.room.name!==t){const o=e.room.findExitTo(t);if(o!==ERR_NO_PATH&&o!==ERR_INVALID_ARGS){const t=e.pos.findClosestByRange(o);if(t)return e.moveTo(t,{visualizePathStyle:{stroke:"#ffffff"}}),!0}}return!1}}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}var r={};(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.loop=void 0;const t=o(77),n=o(978),s=o(594),a=o(119),i=o(180),l=o(623);e.loop=function(){for(const e in Memory.creeps)Game.creeps[e]||delete Memory.creeps[e];let e=Object.values(Game.rooms)[0];if(!e){const t=Object.values(Game.spawns);t.length>0&&(e=t[0].room)}if(!e)return;if(Memory.planning&&Memory.planning.plannedStructures)for(const e of Memory.planning.plannedStructures){if("built"===e.status)continue;const t=new RoomPosition(e.pos.x,e.pos.y,e.pos.roomName);t.lookFor(LOOK_STRUCTURES).some(t=>t.structureType===e.structureType)?e.status="built":e.status=t.lookFor(LOOK_CONSTRUCTION_SITES).length>0?"building":"to_build"}if((0,t.planStructures)(e),Memory.planning&&Memory.planning.plannedStructures){const t=Memory.planning.plannedStructures.filter(e=>"to_build"===e.status);for(const o of t)e.createConstructionSite(o.pos.x,o.pos.y,o.structureType)}const o=e.find(FIND_MY_STRUCTURES,{filter:{structureType:STRUCTURE_TOWER}});for(const e of o){const t=e.pos.findClosestByRange(FIND_HOSTILE_CREEPS);if(t)e.attack(t);else{const t=e.pos.findClosestByRange(FIND_STRUCTURES,{filter:e=>e.hits<e.hitsMax&&e.structureType!==STRUCTURE_WALL&&e.structureType!==STRUCTURE_RAMPART});t&&e.repair(t)}}const r=e.find(FIND_MY_SPAWNS)[0];if(r&&!r.spawning){const t=_.filter(Game.creeps,t=>t.room.name===e.name),o=_.filter(t,e=>"harvester"===e.memory.role),n=_.filter(t,e=>"supplier"===e.memory.role),s=_.filter(t,e=>"builder"===e.memory.role),a=_.filter(t,e=>"upgrader"===e.memory.role),i=e.find(FIND_SOURCES),u=_.filter(i,e=>(0,l.isSourceSafe)(e)),R=e.controller?e.controller.level:1,c=e.find(FIND_MY_CONSTRUCTION_SITES).length>0,d=o[0],m=(d?_.filter(d.body,e=>e.type===WORK).length:0)<5?2*u.length:u.length,f=Math.max(1,o.length+1),p=c?R<=2?2:1:0,y=R<=3?2:1;0===o.length?e.energyAvailable:e.energyCapacityAvailable;let T=null;if(o.length<u.length?T="harvester":n.length<1?T="supplier":a.length<1?T="upgrader":o.length<m?T="harvester":s.length<p?T="builder":n.length<f?T="supplier":a.length<y&&(T="upgrader"),T){const t=0===o.length||0===n.length&&o.length>0?e.energyAvailable:e.energyCapacityAvailable,s=(0,l.generateBody)(T,t);let a=0;for(const e of s)a+=BODYPART_COST[e];e.energyAvailable>=a&&r.spawnCreep(s,T.charAt(0).toUpperCase()+T.slice(1)+Game.time,{memory:{role:T}})}}for(const e in Game.creeps){const t=Game.creeps[e];t.spawning||("harvester"===t.memory.role?(0,n.runHarvester)(t):"builder"===t.memory.role?(0,a.runBuilder)(t):"supplier"===t.memory.role?(0,s.runSupplier)(t):"upgrader"===t.memory.role&&(0,i.runUpgrader)(t))}}})();var n=exports;for(var s in r)n[s]=r[s];r.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();